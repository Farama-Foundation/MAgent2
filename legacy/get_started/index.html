<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="description" content="">
    <meta property="og:title" content="MAgent2 Documentation" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="" />
    <meta property="og:url" content="https://magent2.farama.org/legacy/get_started.html" /><meta name="twitter:card" content="summary_large_image"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" />
        <link rel="canonical" href="https://magent2.farama.org/legacy/get_started.html" />

    <link rel="shortcut icon" href="../../_static/magent2.svg"/><meta name="generator" content="sphinx-5.2.3, furo 2022.09.15.dev1"/>
        <title>Get started - MAgent2 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=3cf7b839e8c50b5f3a39bb99d90baa7b845de926" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=24b18ece81cb9ff18679a2945b9c89ba44829d18" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <header class="farama-header" aria-label="Farama header">
      <div class="farama-header__container">
        <div class="farama-header__left--mobile">
          <label class="nav-overlay-icon" for="__navigation">
            <div class="visually-hidden">Toggle site navigation sidebar</div>
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <defs></defs>
              <line x1="0.5" y1="4" x2="23.5" y2="4"></line>
              <line x1="0.232" y1="12" x2="23.5" y2="12"></line>
              <line x1="0.232" y1="20" x2="23.5" y2="20"></line>
            </svg>
            <!-- <svg viewBox="0 0 24 24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <line x1="0.5" y1="4.5" x2="23.5" y2="4.5" style="fill: none; "></line>
              <line x1="0.5" y1="12" x2="14" y2="12" ></line>
              <line x1="0.5" y1="19.5" x2="23.5" y2="19.5"></line>
              <polyline style="stroke-width: 0px;" points="17 7 22 12 17 17"></polyline>
            </svg> -->
            <!-- <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="width:20px">
              <defs></defs>
              <rect y="1" width="22" height="22" rx="2" ry="2" style="fill: none;" x="1"></rect>
              <line x1="8" y1="1" x2="8" y2="23"></line>
              <polyline style="stroke-linecap: round; fill: none; stroke-linejoin: round;" points="13 7 17 12 13 17"></polyline>
            </svg> -->
          </label>
        </div>
        <div class="farama-header__left farama-header__center--mobile">
          <a href="../../">
              <img class="farama-header__logo only-light" src="../../_static/img/magent2.svg" alt="Light Logo"/>
              <img class="farama-header__logo only-dark" src="../../_static/img/magent2-white.svg" alt="Dark Logo"/>
            <span class="farama-header__title">MAgent2 Documentation</span>
          </a>
        </div>
        <div class="farama-header__right">
          <div class="farama-header-menu">
            <button class="farama-header-menu__btn" aria-label="Open Farama Menu" aria-expanded="false" aria-haspopup="true" aria-controls="farama-menu">
              <img class="farama-white-logo-invert" src="../../_static/img/farama-logo-header.svg">
              <svg viewBox="0 0 24 24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <polyline style="stroke-linecap: round; stroke-linejoin: round; fill: none; stroke-width: 2px;" points="1 7 12 18 23 7"></polyline>
              </svg>
            </button>
            <div class="farama-header-menu-container farama-hidden" aria-hidden="true" id="farama-menu">
              <div class="farama-header-menu__header">
                <a href="https://farama.org">
                  <img class="farama-header-menu__logo farama-white-logo-invert" src="../../_static/img/farama_solid_white.svg" alt="Farama Foundation logo">
                  <span>Farama Foundation</span>
                </a>
                <div class="farama-header-menu-header__right">
                  <button id="farama-close-menu">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-close">
                      <line x1="3" y1="21" x2="21" y2="3"></line>
                      <line x1="3" y1="3" x2="21" y2="21"></line>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="farama-header-menu__body">
                <!-- Response from farama.org/api/projects.json -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
   <!--<header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">MAgent2 Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>-->
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="farama-sidebar__title" href="../../">
      <img class="farama-header__logo only-light" src="../../_static/img/magent2.svg" alt="Light Logo"/>
      <img class="farama-header__logo only-dark" src="../../_static/img/magent2-white.svg" alt="Dark Logo"/>
    <span class="farama-header__title">MAgent2 Documentation</span>
  </a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/basic_usage/">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/key_concepts/">Key Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../API/config/">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../API/gridworld/">GridWorld</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../environments/adversarial_pursuit/">Adversarial Pursuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environments/battle/">Battle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environments/battlefield/">Battlefield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environments/combined_arms/">Combined Arms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environments/gather/">Gather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environments/tiger_deer/">Tiger Deer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Farama-Foundation/magent2">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
    
    <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/Farama-Foundation/MAgent2/edit/main/docs/legacy/get_started.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
          <section id="get-started">
<h1>Get started<a class="headerlink" href="#get-started" title="Permalink to this heading">#</a></h1>
<p>This tutorial will tell you the basic setting of the gridworld in MAgent, and show how to run the first demo.</p>
<section id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Permalink to this heading">#</a></h2>
<p>The basic environment is a large gridworld. Agents and walls can be added in the world.</p>
</section>
<section id="agents">
<h2>Agents<a class="headerlink" href="#agents" title="Permalink to this heading">#</a></h2>
<p>Agents are controlled by groups. Agents in a group share the same general attributes and control method.
The attributes of an agent can be width, height, speed, hp, etc. An AgentType can be registered as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">predator</span> <span class="o">=</span> <span class="n">register_agent_type</span><span class="p">(</span>
    <span class="s2">&quot;predator&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;view_range&#39;</span><span class="p">:</span> <span class="n">CircleRange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;attack_range&#39;</span><span class="p">:</span> <span class="n">CircleRange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="s1">&#39;attack_penalty&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span>
    <span class="p">})</span>
</pre></div>
</div>
</section>
<section id="observation">
<h2>Observation<a class="headerlink" href="#observation" title="Permalink to this heading">#</a></h2>
<p>There are two parts in observation, spacial local view and non-spacial feature (see figure below).</p>
<ul class="simple">
<li><p>Spatial view consists of several rectangular channels. These channels will be masked by a circle or a sector as described in the agent type registration. (see view_range above).
If the radius of a circle is 5, then the size of one channel is 11 x 11, where 11 = 5x2 + 1</p></li>
<li><p>Non-spatial feature includes ID embedding, last action, last reward and normalized position.
ID embedding is the binary representation of agent’s unique ID.</p></li>
</ul>
<img src="../data/figure/observation_space.png" width="350">
<p>The whole observation is an array of shape <code class="docutils literal notranslate"><span class="pre">(n_agents,</span> <span class="pre">view_width,</span> <span class="pre">view_height,</span> <span class="pre">n_channel)</span></code> for all agents.
The above figure shows the observation for one agent. The spatial view contains 7 channels. <code class="docutils literal notranslate"><span class="pre">Wall</span></code> channel
is a “0/1” indicator to show whether there is a wall. <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">2</span></code> is the “0/1” indicators for agents in
group 1, group 2. <code class="docutils literal notranslate"><span class="pre">Hp</span></code> is the normalized health point (range 0-1). <code class="docutils literal notranslate"><span class="pre">Minimap</span></code> is used to give a fuzzy global
observation to the agents （no fog of war). The value in the minimap channel is computed as follows:</p>
<ol class="arabic simple">
<li><p>Squeeze global map (e.g. 100x100) into minimap (e.g. 10x10)</p></li>
<li><p>The value of a minimap cell = (number of agents in this cell) / (number of all the agents)</p></li>
</ol>
</section>
<section id="action">
<h2>Action<a class="headerlink" href="#action" title="Permalink to this heading">#</a></h2>
<p>Actions are discrete actions. They can be move, attack and turn.
In the figure below, move range and attack range are also circular range (chunked to fit grids).
The center point is the body point of the agent. Each point in the figure is a valid action.
So if agent is configured as follow, it has 13 + 8 + 2 = 23 valid actions.</p>
<img src="../data/figure/action_space.png" width="300">
</section>
<section id="reward">
<h2>Reward<a class="headerlink" href="#reward" title="Permalink to this heading">#</a></h2>
<p>Reward can be defined by constant attributes of agent type or by event trigger.
Here is an example of the event trigger fashion. Boolean expression is supported. Two tigers can get reward when attack a deer simultaneously.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">AgentSymbol</span><span class="p">(</span><span class="n">tiger_group</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">AgentSymbol</span><span class="p">(</span><span class="n">tiger_group</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">AgentSymbol</span><span class="p">(</span><span class="n">deer_group</span><span class="p">,</span>  <span class="n">index</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>

<span class="c1"># tigers get reward when they attack a deer simultaneously</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;attack&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;attack&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">add_reward_rule</span><span class="p">(</span><span class="n">e1</span> <span class="o">&amp;</span> <span class="n">e2</span><span class="p">,</span> <span class="n">receiver</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>See <span class="xref myst">python/magent/builtin/config</span> for more examples.
Of course, you can also write your own reward rules in the control logic in python code.</p>
</section>
<section id="game-loop-model-parallelism">
<h2>Game loop &amp; Model parallelism<a class="headerlink" href="#game-loop-model-parallelism" title="Permalink to this heading">#</a></h2>
<p>In Magent, agents are controlled by groups. You should use group handle to manipulate agents.
A typical main loop of a game is listed as follows. It is worth noting that groups can infer action in parallel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">handles</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_handles</span><span class="p">()</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
    <span class="c1"># take action for every group</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">obs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_observation</span><span class="p">(</span><span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_agent_id</span><span class="p">(</span><span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># let models infer action in parallel (non-blocking)</span>
        <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">infer_action</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">acts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fetch_action</span><span class="p">()</span>  <span class="c1"># fetch actions (blocking)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">set_action</span><span class="p">(</span><span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">acts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<p>Also, you can train different groups in parallel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># train models in parallel</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">total_loss</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fetch_train</span><span class="p">()</span>
</pre></div>
</div>
<p>Furthermore, with several lines of modification in python (use socket instead of pipe), models can be deployed to different machines.</p>
</section>
<section id="run-the-first-demo">
<h2>Run the first demo<a class="headerlink" href="#run-the-first-demo" title="Permalink to this heading">#</a></h2>
<p>Run the following command in the root directory, do not cd to <code class="docutils literal notranslate"><span class="pre">examples/</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/python:<span class="nv">$PYTHONPATH</span>
python<span class="w"> </span>examples/api_demo.py
</pre></div>
</div>
<p>In this environment, predators are pursuing preys. Predators can get rewards by attacking preys.
The predators and preys are trained by Deep Q-Network.
After training, predators learn to lock preys by cooperating with each other.<br />
See the source file <span class="xref myst">api_demo.py</span> to know the basic api and workload of MAgent.
See also <span class="xref myst">train_pursuit.py</span> to know how the above agents are trained.</p>
</section>
<section id="watch-video">
<h2>Watch video<a class="headerlink" href="#watch-video" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Go to directory <code class="docutils literal notranslate"><span class="pre">build/render</span></code></p></li>
<li><p>Execute <code class="docutils literal notranslate"><span class="pre">./render</span></code></p></li>
<li><p>Open index.html in browser. A modal will be opened once the frontend gets connected to the backend</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">config.json</span></code> and <code class="docutils literal notranslate"><span class="pre">video_1.txt</span></code> in the two input boxes.</p></li>
<li><p>In the render, press arrow keys ‘up’, ‘down’, ‘left’, ‘right’ to move scope window. Press ‘&lt;’, ‘&gt;’ to zoom in or zoom out. Press ‘s’ to adjust speed and progress. Press ‘e’ to re-input configuration file and map file.</p></li>
</ul>
</section>
<section id="play-general-soldier-game">
<h2>Play general-soldier game<a class="headerlink" href="#play-general-soldier-game" title="Permalink to this heading">#</a></h2>
<p>In this section, Pygame are required.<br />
<strong>Note for OSX user</strong>: Unluckily, there is something wrong with Pygame on OSX, which makes this game very slow. You can skip this game if you are on OSX.</p>
<div class="highlight-base notranslate"><div class="highlight"><pre><span></span>pip install pygame
python examples/show_battle_game.py
</pre></div>
</div>
<p>In this game, you will act as a general and dispatch your soldiers.
You have 10 chances to place your soldiers in the map.
Then the soldiers will act according to their deep q-networks.
You goal is to find best places to place your soldiers and let them to eliminate the enemies.</p>
</section>
<section id="next-step">
<h2>Next step<a class="headerlink" href="#next-step" title="Permalink to this heading">#</a></h2>
<p>Try other examples and have fun!</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
            
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022
            </div>
            <!--
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            -->
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link" href="https://github.com/Farama-Foundation/MAgent2" aria-label="On GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Get started</a><ul>
<li><a class="reference internal" href="#environment">Environment</a></li>
<li><a class="reference internal" href="#agents">Agents</a></li>
<li><a class="reference internal" href="#observation">Observation</a></li>
<li><a class="reference internal" href="#action">Action</a></li>
<li><a class="reference internal" href="#reward">Reward</a></li>
<li><a class="reference internal" href="#game-loop-model-parallelism">Game loop &amp; Model parallelism</a></li>
<li><a class="reference internal" href="#run-the-first-demo">Run the first demo</a></li>
<li><a class="reference internal" href="#watch-video">Watch video</a></li>
<li><a class="reference internal" href="#play-general-soldier-game">Play general-soldier game</a></li>
<li><a class="reference internal" href="#next-step">Next step</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div>
    <script>
      const toggleMenu = () => {
        const menuBtn = document.querySelector(".farama-header-menu__btn");
        const menuContainer = document.querySelector(".farama-header-menu-container");
        if (document.querySelector(".farama-header-menu").classList.contains("active")) {
          menuBtn.ariaExpanded = "false";
          menuContainer.ariaHidden = "true";
        } else {
          menuBtn.ariaExpanded = "true";
          menuContainer.ariaHidden = "false";
        }
        document.querySelector(".farama-header-menu").classList.toggle("active");
      }

      document.querySelector(".farama-header-menu__btn").addEventListener("click", toggleMenu);
      document.getElementById("farama-close-menu").addEventListener("click", toggleMenu);
    </script>

    
    <script>
          (() => {
              if (!localStorage.getItem("shownCookieAlert")) {
                  const boxElem = document.createElement("div");
                  boxElem.classList.add("cookie-alert");
                  const containerElem = document.createElement("div");
                  containerElem.classList.add("cookie-alert__container");
                  const textElem = document.createElement("p");
                  textElem.innerHTML = `This page uses <a href="https://analytics.google.com/">
                                      Google Analytics</a> to collect statistics. You can disable it by blocking
                                      the JavaScript coming from www.google-analytics.com.`;
                                      containerElem.appendChild(textElem);
                  const closeBtn = document.createElement("button");
                  closeBtn.innerHTML = `<?xml version="1.0" ?><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1" x1="7" x2="25" y1="25" y2="7"/></g></svg>`
                  closeBtn.onclick = () => {
                      localStorage.setItem("shownCookieAlert", "true");
                      boxElem.style.display = "none";
                  }
                  containerElem.appendChild(closeBtn);
                  boxElem.appendChild(containerElem);
                  document.body.appendChild(boxElem);
              }
          })()
      </script>

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-07SGW5KKJF"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-07SGW5KKJF');
      </script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    
    <script>
      const createCORSRequest = (method, url) => {
        let xhr = new XMLHttpRequest();
        xhr.responseType = 'json';

        if ("withCredentials" in xhr) {
          xhr.open(method, url, true);
        } else if (typeof XDomainRequest != "undefined") {
          // IE8 & IE9
          xhr = new XDomainRequest();
          xhr.open(method, url);
        } else {
          // CORS not supported.
          xhr = null;
        }
        return xhr;
      };

      const url = 'https://farama.org/api/projects.json';
      const imagesBasepath = "https://farama.org/assets/images"
      const method = 'GET';
      let xhr = createCORSRequest(method, url);

      xhr.onload = () => {
        const jsonResponse = xhr.response;
        const sections = {
          "Documentation": [],
          "Mature Projects": [],
          "Incubating Projects": [],
          "Foundation": [
            {
              name: "About",
              link: "https://farama.org/about"
            },
            {
              name: "Standards",
              link: "https://farama.org/project_standards",
            },
            {
              name: "Donate",
              link: "https://farama.org/donations"
            }
          ]
        }
        Object.keys(jsonResponse).forEach(key => {
          projectJson = jsonResponse[key];
          if (projectJson.website !== null) {
            projectJson.link = projectJson.website;
            sections["Documentation"].push(projectJson)
          } else if (projectJson.type == "mature") {
            projectJson.link = projectJson.github;
            sections["Mature Projects"].push(projectJson)
          } else {
            projectJson.link = projectJson.github;
            sections["Incubating Projects"].push(projectJson)
          }
        })

        const menuContainer = document.querySelector(".farama-header-menu__body");

        Object.keys(sections).forEach((key, i) => {
          projects = sections[key];
          const sectionElem = Object.assign(
            document.createElement('div'), {
              className:'farama-header-menu__section',
              style: "padding-left: 24px"
            }
          )
          sectionElem.appendChild(Object.assign(document.createElement('span'),
            {
              className:'farama-header-menu__section-title' ,
              innerText: key
            }
          ))
          const ulElem = Object.assign(document.createElement('ul'),
            {
              className:'farama-header-menu-list',
            }
          )
          for (let project of projects) {
            const liElem = document.createElement("li");
            const aElem = Object.assign(document.createElement("a"),
              {
                href: project.link
              }
            );
            liElem.appendChild(aElem);
            if (key !== "Foundation") {
              const imgElem = Object.assign(document.createElement("img"),
                {
                  src: project.image ? imagesBasepath + project.image : imagesBasepath + "/farama_black.svg",
                  alt: `${project.name} logo`,
                  className: "farama-black-logo-invert"
                }
              );
              aElem.appendChild(imgElem);
            }
            aElem.appendChild(document.createTextNode(project.name));
            ulElem.appendChild(liElem);
          }
          sectionElem.appendChild(ulElem);
          menuContainer.appendChild(sectionElem)
        });
      }

      xhr.onerror = function() {
        console.error("Unable to load projects");
      };

      xhr.send();
    </script>

    
    </body>
</html>